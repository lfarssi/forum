<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="/css/index.css"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script>
        function filterByCategory(category) {
    window.location.href = '/filter-posts?category=' + encodeURIComponent(category);
}

    </script>
</head>
<body>

    <a href="/add-post">Add Post</a>
    <div class="right-menu">
        <ul>
            <!-- <li><a href="#" onclick="filterByCategory('All')">Home</a></li> -->
            <li class="dropdown">
                <p>Categories: </p>
                <div class="dropdown-content">
                    {{range .Categories}}
                    <br>
                    <a href="#" onclick="filterByCategory('{{.Name}}')">{{.Name}}</a>
                    {{end}}
                </div>
            </li>
        </ul>
    </div>
    

<div class="posts-container">


    <!-- Loop through each post -->
    {{range .Posts}}
        <div class="post" id="post_{{.ID}}">
            <h2 class="post-title">{{.Title}}</h2>
            
            <p class="post-content">{{.Content}}</p>
            <p class="post-content">{{.Username}}</p>
            <p class="post-content">{{.CreatedAt.Format "02 Jan 2006"}}</p>
            <!-- Display categories -->
            <p class="post-category">Categories: 
                {{range .Categories}}
                    {{.}}
                {{end}}
            </p>

            <p class="post-likes"><i class="fa-solid fa-thumbs-up"></i>{{.Likes}}</p>
            <p class="post-dislikes"><i class="fa-regular fa-thumbs-down"></i> {{.Dislikes}}</p>

            <div class="comments-section">
                <h3>Comments:</h3>
                {{if .Comments}}
                    <ol class="comments-list">
                        <!-- Loop through each comment -->
                        {{range .Comments}}
                            <li class="comment" id="comment_{{.ID}}">
                                <div class="comment-content">
                                    <p>{{.Content}}</p>
                                    <small>Posted by: {{.Username}} on {{.CreatedAt.Format "02 Jan 2006"}}</small>
                                    <p class="comment-likes"><i class="fa-regular fa-thumbs-up"></i>{{.Likes}}</p>
                                    <p class="comment-dislikes"><i class="fa-solid fa-thumbs-down"></i> {{.Dislikes}}</p>
                                </div>
                            </li>
                        {{end}}
                    </ol>
                {{else}}
                    <p>No comments yet.</p>
                {{end}}
            </div>

            <!-- Form to add a new comment -->
            <div class="add-comment-form">
                <h4>Add a Comment:</h4>
                <form action="/add_comment" method="POST">
                    <input type="hidden" name="post_id" value="{{.ID}}">
                    <textarea name="content" required placeholder="Write your comment here..."></textarea>
                    <button type="submit">Submit</button>
                </form>
            </div>
        </div> 
    {{end}}
</div>

</body>
</html>
